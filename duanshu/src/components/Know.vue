<template>
  <div class="knowledge-container">
    <div class="layer layer-1">
      <img src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/bn.jpg" alt="短书" />
      <div class="layer-wrapper">
        <h2>重视每一个内容创作者的价值</h2>
        <h3>更加适合中小企业和机构的知识小店</h3>
        <a href="javascript:void(0);" class="reg-btn">立即开启</a>
      </div>
    </div>
    <div class="layer layer-2">
      <h2>知识变现一体化解决方案</h2>
      <h3>一个软件解决内容变现的所有问题</h3>
      <div class="block-list middle-layout">
        <div class="block">
          <img
            alt="短书"
            data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-2/nrzx.png"
            src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-2/nrzx.png"
            lazy="loaded"
          />
          <h4>内容展现</h4>
          <div>
            <p>直播、图文、音视频</p>
            <p>课程、专栏</p>
            <p>安卓、iOS、小程序</p>
          </div>
        </div>
        <div class="block">
          <img
            alt="短书"
            data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-2/yhyy.png"
            src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-2/yhyy.png"
            lazy="loaded"
          />
          <h4>用户运营</h4>
          <div>
            <p>小社群粉丝管理</p>
            <p>会员和积分管理</p>
            <p>精准用户画像</p>
            <p>多渠道用户沉淀</p>
          </div>
        </div>
        <div class="block">
          <img
            alt="短书"
            data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-2/yycb.png"
            src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-2/yycb.png"
            lazy="loaded"
          />
          <h4>营销传播</h4>
          <div>
            <p>内容分销返利、打折、</p>
            <p>拼团、抽奖、团购…</p>
            <p>广告专题营销</p>
          </div>
        </div>
        <div class="block">
          <img
            alt="短书"
            data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-2/aqjy.png"
            src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-2/aqjy.png"
            lazy="loaded"
          />
          <h4>安全交易</h4>
          <div>
            <p>合法支付牌照</p>
            <p>快捷移动支付</p>
            <p>T+2快速大额提现</p>
          </div>
        </div>
        <div class="block">
          <img
            alt="短书"
            data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-2/sjfx.png"
            src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-2/sjfx.png"
            lazy="loaded"
          />
          <h4>数据分析</h4>
          <div>
            <p>实时指标监测</p>
            <p>运营效果多维度分析</p>
            <p>增长数据可视化</p>
          </div>
        </div>
        <div class="block">
          <img
            alt="短书"
            data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-2/ppjz.png"
            src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-2/ppjz.png"
            lazy="loaded"
          />
          <h4>品牌价值</h4>
          <div>
            <p>独立品牌小店</p>
            <p>全平台渠道曝光</p>
            <p>增强用户认知</p>
            <p>店铺易传播、可搜索</p>
          </div>
        </div>
      </div>
    </div>
    <div class="layer layer-3">
      <h2>更全面的内容变现形式</h2>
      <h3>满足各种内容形态和变现需求</h3>
      <div class="slide-wrap">
        <div class="slide-pagins middle-layout">
          <div class="item item-1">
            <div class="tap-item flexbox-center">
              <img
                alt="短书"
                class="icon"
                data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-3/ffyp.png"
                src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-3/ffyp.png"
                lazy="loaded"
              />
            </div>
            <div class="bubble"></div>
            <div>
              <h4>付费音频 付费视频 付费图文</h4>
              <p>支持Android、iOS、小程序和H5，更好 的支持主流内容</p>
            </div>
          </div>
          <div class="item item-2">
            <div class="tap-item flexbox-center">
              <img
                alt="短书"
                class="icon"
                data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-3/zb.png"
                src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-3/zb.png"
                lazy="loaded"
              />
            </div>
            <div class="bubble"></div>
            <div>
              <h4>付费直播</h4>
              <p>多种新进的直播形式，让各类课程、演示 和教学犹如现场</p>
            </div>
          </div>
          <div class="item item-3 active">
            <div class="tap-item flexbox-center">
              <img
                alt="短书"
                class="icon"
                data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-3/ffsq.png"
                src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-3/ffsq.png"
                lazy="loaded"
              />
            </div>
            <div class="bubble"></div>
            <div>
              <h4>付费小社群 付费会员</h4>
              <p>灵活方便的轻量级UGC社区，让双向交 流、粉丝互动、内容管理如此轻松</p>
            </div>
          </div>
          <div class="item item-4">
            <div class="tap-item flexbox-center">
              <img
                alt="短书"
                class="icon"
                data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-3/kc.png"
                src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-3/kc.png"
                lazy="loaded"
              />
            </div>
            <div class="bubble"></div>
            <div>
              <h4>付费课程 付费专栏</h4>
              <p>适合系列内容、连载专栏等内容形式， 让读者循序渐进的学习知识</p>
            </div>
          </div>
        </div>
        <div class="slide-content">
          <div class="slide-inner" style="left: -590px;">
            <img
              id="pic-1"
              alt="短书"
              data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-3/audio.png"
              src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-3/audio.png"
              lazy="loaded"
            />
            <img
              id="pic-2"
              alt="短书"
              data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-3/live.png"
              src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-3/live.png"
              lazy="loaded"
            />
            <img
              id="pic-3"
              alt="短书"
              data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-3/community.png"
              src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-3/community.png"
              lazy="loaded"
            />
            <img
              id="pic-4"
              alt="短书"
              data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-3/course.png"
              src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-3/course.png"
              lazy="loaded"
            />
          </div>
        </div>
      </div>
    </div>
    <div class="layer layer-4">
      <h2>真正的流媒体直播，多种场合都能得心应手</h2>
      <h3>短书率先提供OBS录屏、实时流媒体、远程互动等完善的直播解决方案</h3>
      <div class="slide-wrap">
        <div class="slide-pagins middle-layout">
          <div class="item item-1">
            <div class="tap-item flexbox-center">
              <img
                alt="短书"
                class="icon"
                data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-4/obs.png"
                src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-4/obs.png"
                lazy="loaded"
              />
            </div>
            <div class="bubble"></div>
            <div>
              <h4>OBS录屏直播</h4>
              <p>
                PC/移动端屏幕录制并推流，全平台实时
                <br />观看直播。软件教学、操作演示更轻松
              </p>
            </div>
          </div>
          <div class="item item-2">
            <div class="tap-item flexbox-center">
              <img
                alt="短书"
                class="icon"
                data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-4/1d1.png"
                src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-4/1d1.png"
                lazy="loaded"
              />
            </div>
            <div class="bubble"></div>
            <div>
              <h4>远程1对1直播</h4>
              <p>
                通过APP实现双向直播互动，1对1教学培
                <br />训也能得心应手
              </p>
            </div>
          </div>
          <div class="item item-3">
            <div class="tap-item flexbox-center">
              <img
                alt="短书"
                class="icon"
                data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-4/dxzb.png"
                src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-4/dxzb.png"
                lazy="loaded"
              />
            </div>
            <div class="bubble"></div>
            <div>
              <h4>大型现场直播</h4>
              <p>
                通过摄像设备或手机APP，实时传输现场画
                <br />面。活动直播、细节演示、在线课堂更简单
              </p>
            </div>
          </div>
          <div class="item item-4 active">
            <div class="tap-item flexbox-center">
              <img
                alt="短书"
                class="icon"
                data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-4/whd.png"
                src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-4/whd.png"
                lazy="loaded"
              />
            </div>
            <div class="bubble"></div>
            <div>
              <h4>微互动直播</h4>
              <p>
                音/视频互动直播运营成本较低，非常适合
                <br />个人和团队针对知识主题进行分享和授课
              </p>
            </div>
          </div>
        </div>
        <div class="slide-content">
          <div class="slide-inner" style="left: -890px;">
            <img
              id="pic-1"
              data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-4/obslive.png"
              src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-4/obslive.png"
              lazy="loaded"
            />
            <img
              id="pic-2"
              data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-4/1vs1.png"
              src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-4/1vs1.png"
              lazy="loaded"
            />
            <img
              id="pic-4"
              data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-4/big.png"
              src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-4/big.png"
              lazy="loaded"
            />
            <img
              id="pic-3"
              data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-4/interact.png"
              src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-4/interact.png"
              lazy="loaded"
            />
          </div>
        </div>
      </div>
    </div>
    <div class="layer layer-5">
      <h2>强力营销功能，引爆社交裂变传播</h2>
      <div class="tap-item-list flexbox">
        <div>
          <div class="tap-item flexbox-center">
            <img
              alt="短书"
              class="icon"
              data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-5/fx.png"
              src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-5/fx.png"
              lazy="loaded"
            />
          </div>
          <p>分销返利</p>
        </div>
        <div>
          <div class="tap-item flexbox-center">
            <img
              alt="短书"
              class="icon"
              data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-5/hy.png"
              src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-5/hy.png"
              lazy="loaded"
            />
          </div>
          <p>会员积分</p>
        </div>
        <div>
          <div class="tap-item flexbox-center">
            <img
              alt="短书"
              class="icon"
              data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-5/xsg.png"
              src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-5/xsg.png"
              lazy="loaded"
            />
          </div>
          <p>限时折扣</p>
        </div>
        <div>
          <div class="tap-item flexbox-center">
            <img
              alt="短书"
              class="icon"
              data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-5/yqk.png"
              src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-5/yqk.png"
              lazy="loaded"
            />
          </div>
          <p>邀请卡</p>
        </div>
        <div>
          <div class="tap-item flexbox-center">
            <img
              alt="短书"
              class="icon"
              data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-5/pt.png"
              src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-5/pt.png"
              lazy="loaded"
            />
          </div>
          <p>拼团</p>
        </div>
      </div>
      <!-- 轮播图 -->
      <div id="slideRoll" class="slide-wrap">
        <div class="slide-inner">
          <div class="slide-block"></div>
          <div class="slide-item-list" @mouseover="stop" @mouseleave="play">
            <div class="flexbox-center roll-inner" :style="containerStyle">
              <div class="slide-item" v-for="(item,index) in imgs" :key="index" >
                <img
                  data-src="//duanshu-web.oss-cn-beijing.aliyuncs.com/static/image/knowledge/layer-5/generalize.png"
                  :src="item"
                  lazy="loaded"
                  :style="{width:imgWidth+'px'}"
                />
              </div>
            </div>
          </div>
          <div class="slide-block hollow"></div>
        </div>
      </div>
    </div>
  </div>
</template>
<script>
export default {
  name: "slide-item-list",
  props: {
     initialSpeed: {
      type: Number,
      default: 30
    },
    initialInterval: {
      type: Number,
      default: 3
    }
  },
  data() {
    return {
      imgs: [],
      imgWidth:260,
      distance: -260,
      transitionEnd: true,
      speed: this.initialSpeed,
      currentIndex:1,
      active:'active'
    };
  },
  async created() {
    const imgs = await this.$axios(
      "https://www.easy-mock.com/mock/5d48d6e867bb5574f3cd36a5/imgs/"
    );
    this.imgs = imgs.data.data;
  },
  computed: {
    containerStyle() {
      return {
        transform: `translate3d(${this.distance}px, 0, 0)`
      };
    },
    interval() {
      return this.initialInterval * 1000
    }
  },
   mounted() {
    this.init()
  },
  methods:{
    init(){
      this.play();
      window.onblur =function(){
        this.stop()
      }.bind(this);
      window.onfocus =function(){
        this.play()
      }.bind(this)
    },
     move(offset, direction, speed) {
      
      if (!this.transitionEnd) return
      this.transitionEnd = false
      direction === -1 ? this.currentIndex += offset/260 : this.currentIndex -= offset/260
      // this.currentIndex=parseInt(this.currentIndex);
      
      if (this.currentIndex >8) this.currentIndex = 3
      if (this.currentIndex < 3) this.currentIndex = 8

      const destination = this.distance + offset * direction
      this.animate(destination, direction, speed)
    },
    animate(des, direc, speed) {
      if (this.temp) {
        window.clearInterval(this.temp);
        this.temp = null ;
      }
      this.temp = window.setInterval(() => {
        if ((direc === -1 && des < this.distance) || (direc === 1 && des > this.distance)) {
          this.distance += speed * direc
        } else {
          this.transitionEnd = true
          window.clearInterval(this.temp)
          this.distance = des
          if (des < -1560) this.distance = 0
          if (des > 0) this.distance = -1560
        }
      }, 20)
    },
    play() {
      if (this.timer) {
        window.clearInterval(this.timer)
        this.timer = null
      }
      this.timer = window.setInterval(() => {
        this.move(245, -1, this.speed);
        // this.currentIndex.add('active');
      // console.log(this);
      }, this.interval)
    },
    stop() {
      window.clearInterval(this.timer)
      this.timer = null
    }
  }
};
</script>

<style>
.knowledge-container .layer-5 .slide-wrap .slide-inner .slide-block{
  z-index: 2;
  opacity: 0.6;
}
/* .knowledge-container .layer-5 .slide-wrap .slide-inner .slide-block */
</style>
